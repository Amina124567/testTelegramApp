<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flower Shop - –≠–ª–∏—Ç–Ω—ã–µ –±—É–∫–µ—Ç—ã</title>
    <script src="https://telegram.org/js/telegram-web-app.js?2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{
            --primary:#dc2626;--primary-dark:#b91c1c;--primary-light:#fecaca;
            --secondary:#ef4444;--secondary-dark:#dc2626;--accent:#dc2626;
            --accent-dark:#b91c1c;--text:#1f2937;--text-light:#6b7280;
            --text-lighter:#9ca3af;--bg:#ffffff;--bg-secondary:#f8fafc;
            --bg-tertiary:#f1f5f9;--card-bg:#ffffff;--shadow:0 4px 12px rgba(0,0,0,0.08);
            --shadow-lg:0 10px 25px rgba(0,0,0,0.12);--shadow-sm:0 1px 4px rgba(0,0,0,0.06);
            --border:1px solid #e5e7eb;--radius:16px;--radius-sm:10px;--radius-lg:20px;
            --header-bg:linear-gradient(135deg,#667eea 0%,#764ba2 100%)
        }
        body{
            font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            color:var(--text);min-height:100vh;line-height:1.5
        }
        .app-container{max-width:400px;margin:0 auto;background:var(--bg);min-height:100vh;position:relative;overflow-x:hidden}
        
        .header{background:var(--header-bg);color:white;padding:40px 20px 30px;text-align:center;position:relative;overflow:hidden}
        .header::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="flowers" x="0" y="0" width="30" height="30" patternUnits="userSpaceOnUse"><circle cx="15" cy="15" r="5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23flowers)"/></svg>')}
        .header-content{position:relative;z-index:2}
        .header h1{font-size:28px;font-weight:800;margin-bottom:6px;text-shadow:0 2px 4px rgba(0,0,0,0.2)}
        .header p{font-size:14px;opacity:0.95;font-weight:500;margin-bottom:12px}
        
        .products-grid{padding:16px;display:grid;gap:16px;padding-bottom:80px}
        .product-card{background:var(--card-bg);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);transition:all 0.3s ease;border:var(--border)}
        .product-card:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
        .product-image{width:100%;height:180px;background:linear-gradient(135deg,#ffe8e8 0%,#ffd6d6 100%);position:relative;overflow:hidden}
        .product-image img{width:100%;height:100%;object-fit:cover}
        .product-content{padding:16px}
        .product-title{font-size:16px;font-weight:700;margin-bottom:6px;color:var(--text);line-height:1.3}
        .product-description{font-size:13px;color:var(--text-light);margin-bottom:10px;line-height:1.4}
        .product-footer{display:flex;justify-content:space-between;align-items:center}
        .product-price{font-size:18px;font-weight:800;color:var(--secondary)}
        .order-btn{background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);color:white;border:none;border-radius:16px;padding:12px 16px;font-weight:600;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:6px;font-size:13px;min-height:44px}
        .order-btn:hover{transform:scale(1.05)}
        
        .floating-buttons{position:fixed;bottom:16px;right:16px;display:flex;flex-direction:column;gap:8px;z-index:1000}
        .admin-button{background:linear-gradient(135deg,var(--accent) 0%,var(--accent-dark) 100%);color:white;border:none;border-radius:40px;padding:14px;font-size:16px;cursor:pointer;box-shadow:var(--shadow-lg);transition:all 0.2s ease;display:none;min-height:44px;min-width:44px;align-items:center;justify-content:center}
        
        .modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;z-index:2000;padding:16px;backdrop-filter:blur(5px)}
        .modal-content{background:white;border-radius:var(--radius-lg);padding:20px;max-width:360px;width:100%;max-height:80vh;overflow-y:auto;animation:modalSlideIn 0.3s ease;box-shadow:var(--shadow-lg)}
        @keyframes modalSlideIn{from{opacity:0;transform:translateY(30px)} to{opacity:1;transform:translateY(0)}}
        .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:2px solid #f0f0f0}
        .modal-title{font-size:18px;font-weight:800;color:var(--text);display:flex;align-items:center;gap:6px}
        .close-modal{background:none;border:none;font-size:24px;cursor:pointer;color:var(--text-light);width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;min-height:44px;min-width:44px}
        .close-modal:hover{background:#f0f0f0}
        
        .loading{text-align:center;padding:30px 16px;color:var(--text-light)}
        .loading-spinner{border:3px solid #f3f3f3;border-top:3px solid var(--primary);border-radius:50%;width:32px;height:32px;animation:spin 1s linear infinite;margin:0 auto 16px}
        @keyframes spin{0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)}}
        
        .admin-panel{display:none;background:var(--bg);min-height:100vh}
        .admin-header{background:linear-gradient(135deg,#4f46e5 0%,#7c3aed 100%);color:white;padding:18px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:var(--border)}
        .admin-title{font-size:18px;font-weight:700}
        .admin-switch{background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3);color:white;padding:8px 14px;border-radius:12px;font-weight:600;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:6px;font-size:13px;min-height:44px}
        .admin-switch:hover{background:rgba(255,255,255,0.3)}
        
        .admin-tabs{display:flex;gap:6px;padding:12px;background:var(--bg-secondary);border-bottom:var(--border);overflow-x:auto}
        .admin-tab{padding:10px 14px;border:2px solid #e5e7eb;border-radius:12px;background:white;color:var(--text);font-weight:600;white-space:nowrap;cursor:pointer;transition:all 0.2s ease;font-size:12px;display:flex;align-items:center;gap:4px;flex-shrink:0;min-height:44px}
        .admin-tab.active{background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);color:white;border-color:var(--primary)}
        .admin-content{padding:16px}
        .admin-tab-content{display:none}
        .admin-tab-content.active{display:block}
        
        .stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}
        .stat-card{background:white;padding:16px;border-radius:var(--radius);box-shadow:var(--shadow);text-align:center;border-left:3px solid var(--primary)}
        .stat-value{font-size:20px;font-weight:800;color:var(--primary);margin-bottom:4px}
        .stat-label{color:var(--text-light);font-size:11px;font-weight:600}
        
        .product-form{background:white;padding:16px;border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:16px;border:var(--border)}
        .form-title{font-size:16px;font-weight:700;margin-bottom:12px;color:var(--text);display:flex;align-items:center;gap:6px;cursor:pointer}
        .form-title i{transition:transform 0.2s ease}
        .form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
        .form-full{grid-column:1/-1}
        .form-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
        .collapsible-content{max-height:0;overflow:hidden;transition:max-height 0.3s ease}
        .collapsible-content.expanded{max-height:500px}
        
        .search-box{background:white;padding:12px;border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:12px;border:var(--border)}
        .search-input{width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:10px;font-size:13px;min-height:44px}
        .search-input:focus{outline:none;border-color:var(--primary)}
        
        .admin-table{background:white;border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);margin-bottom:16px;border:var(--border)}
        .table-header{padding:12px 16px;background:#f8fafc;border-bottom:1px solid #e5e7eb;font-weight:700;display:grid;gap:8px;font-size:12px;color:var(--text)}
        .table-row{padding:12px 16px;border-bottom:1px solid #f0f0f0;display:grid;gap:8px;align-items:center;font-size:12px;color:var(--text-light);transition:all 0.2s ease}
        .table-row:hover{background:#f8f9fa}
        .table-row:last-child{border-bottom:none}
        
        .btn{padding:10px 14px;border:none;border-radius:8px;cursor:pointer;font-weight:600;font-size:12px;transition:all 0.2s ease;display:inline-flex;align-items:center;gap:4px;min-height:44px}
        .btn:hover{transform:translateY(-1px)}
        .btn-primary{background:linear-gradient(135deg,#10b981 0%,#059669 100%);color:white}
        .btn-secondary{background:#6b7280;color:white}
        .btn-danger{background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%);color:white}
        .btn-sm{padding:8px 12px;font-size:11px}
        .btn-lg{padding:12px 18px;font-size:14px}
        
        .toast{position:fixed;top:16px;left:50%;transform:translateX(-50%) translateY(-80px);color:white;padding:12px 18px;border-radius:20px;box-shadow:var(--shadow-lg);z-index:3000;transition:all 0.3s ease;font-weight:600;display:flex;align-items:center;gap:8px;opacity:0;backdrop-filter:blur(10px);font-size:14px}
        .toast.show{transform:translateX(-50%) translateY(0);opacity:1}
        .toast.success{background:linear-gradient(135deg,#10b981 0%,#059669 100%)}
        .toast.error{background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%)}
        .toast.info{background:linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%)}
        
        .empty-table-message{grid-column:1/-1;text-align:center;padding:30px 16px;color:var(--text-light);font-size:14px}
        .role-badge{padding:6px 10px;border-radius:6px;font-size:10px;font-weight:700;text-transform:uppercase}
        .role-owner{background:#fee2e2;color:#dc2626}
        .role-admin{background:#dbeafe;color:#1d4ed8}
        
        .settings-group{margin-bottom:16px}
        .settings-label{font-weight:600;margin-bottom:6px;color:var(--text);font-size:14px}
        .settings-input{width:100%;padding:12px;border:2px solid #e5e7eb;border-radius:10px;font-size:13px;min-height:44px}
        .settings-input:focus{outline:none;border-color:var(--primary)}
        
        .theme-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}
        .theme-option{height:80px;border-radius:12px;cursor:pointer;border:3px solid transparent;transition:all 0.2s ease;position:relative}
        .theme-option.selected{border-color:var(--primary)}
        .theme-option::after{content:'‚úì';position:absolute;top:8px;right:8px;background:var(--primary);color:white;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:bold;opacity:0;transition:opacity 0.2s ease}
        .theme-option.selected::after{opacity:1}
        
        .move-buttons{display:flex;gap:4px}
        .move-btn{padding:6px;border:1px solid #e5e7eb;border-radius:6px;background:white;cursor:pointer;color:var(--text-light);min-height:44px;min-width:44px;display:flex;align-items:center;justify-content:center}
        .move-btn:hover{background:#f8f9fa}
        
        .admin-actions{display:flex;gap:6px;flex-wrap:wrap}
        
        .table-header.products-header{grid-template-columns:50px 1fr 80px 120px}
        .table-header.orders-header{grid-template-columns:60px 1fr 80px 80px 140px}
        .table-header.admins-header{grid-template-columns:60px 1fr 1fr 80px 100px}
        
        .quick-actions{display:flex;gap:8px;padding:12px 16px;background:var(--bg-secondary);border-bottom:var(--border);overflow-x:auto}
        .quick-action-btn{padding:12px 16px;background:white;border:var(--border);border-radius:12px;color:var(--text);font-weight:600;white-space:nowrap;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:6px;font-size:13px;flex-shrink:0;min-height:44px}
        .quick-action-btn:hover{background:var(--primary-light);border-color:var(--primary)}
        .quick-action-btn.primary{background:var(--primary);color:white;border-color:var(--primary)}
        
        .success-state{text-align:center;padding:24px 16px}
        .success-icon{font-size:50px;color:#10b981;margin-bottom:16px}
        .success-title{font-size:20px;font-weight:800;margin-bottom:8px;color:var(--text)}
        .success-message{color:var(--text-light);margin-bottom:20px;line-height:1.4;font-size:14px}
    </style>
</head>
<body>
    <div class="app-container">
        <div class="toast" id="toast">
            <i class="fas fa-check-circle" id="toastIcon"></i>
            <span id="toastMessage">–î–æ–±–∞–≤–ª–µ–Ω–æ</span>
        </div>

        <div class="customer-view" id="customerView">
            <div class="header" id="shopHeader">
                <div class="header-content">
                    <h1 id="shopName">üå∏ Flower Shop</h1>
                    <p>–≠–ª–∏—Ç–Ω—ã–µ –±—É–∫–µ—Ç—ã</p>
                </div>
            </div>

            <div class="products-grid" id="productsGrid">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div>–ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥...</div>
                </div>
            </div>
        </div>

        <div class="admin-panel" id="adminPanel">
            <div class="admin-header">
                <div class="admin-title">üõ†Ô∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
                <button class="admin-switch" onclick="switchToCustomerView()">
                    <i class="fas fa-store"></i> –ú–∞–≥–∞–∑–∏–Ω
                </button>
            </div>

            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="dashboard">
                    <i class="fas fa-chart-bar"></i>–ì–ª–∞–≤–Ω–∞—è
                </div>
                <div class="admin-tab" data-tab="products">
                    <i class="fas fa-shopping-bag"></i>–¢–æ–≤–∞—Ä—ã
                </div>
                <div class="admin-tab" data-tab="orders">
                    <i class="fas fa-clipboard-list"></i>–ó–∞–∫–∞–∑—ã
                </div>
                <div class="admin-tab" data-tab="admins">
                    <i class="fas fa-users"></i>–ê–¥–º–∏–Ω—ã
                </div>
                <div class="admin-tab" data-tab="settings">
                    <i class="fas fa-cog"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </div>
            </div>

            <div class="admin-content">
                <div class="admin-tab-content active" id="dashboardTab">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalOrders">0</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="completedOrders">0</div>
                            <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalRevenue">0 ‚ÇΩ</div>
                            <div class="stat-label">–í—ã—Ä—É—á–∫–∞</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalProducts">0</div>
                            <div class="stat-label">–¢–æ–≤–∞—Ä–æ–≤</div>
                        </div>
                    </div>

                    <div class="quick-actions">
                        <button class="quick-action-btn primary" onclick="loadAdminData()">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                        <button class="quick-action-btn" onclick="showTab('products')">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                        <button class="quick-action-btn" onclick="showTab('orders')">
                            <i class="fas fa-eye"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤
                        </button>
                    </div>
                </div>

                <div class="admin-tab-content" id="productsTab">
                    <div class="product-form">
                        <div class="form-title" onclick="toggleProductForm()">
                            <i class="fas fa-chevron-down" id="productFormIcon"></i>
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
                        </div>
                        <div class="collapsible-content" id="productFormContent">
                            <div class="form-row">
                                <input type="text" id="productName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" class="settings-input">
                                <input type="number" id="productPrice" placeholder="–¶–µ–Ω–∞ –≤ —Ä—É–±–ª—è—Ö" class="settings-input">
                            </div>
                            <div class="form-full">
                                <input type="text" id="productImage" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" class="settings-input">
                            </div>
                            <div class="form-full">
                                <textarea id="productDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" class="settings-input" rows="2"></textarea>
                            </div>
                            <div class="form-actions">
                                <button class="btn btn-primary btn-lg" onclick="addProduct()">
                                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä
                                </button>
                                <button class="btn btn-secondary" onclick="resetProductForm()">
                                    <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="search-box">
                        <input type="text" id="productSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é..." class="search-input" onkeyup="filterProducts()">
                    </div>

                    <div class="admin-table">
                        <div class="table-header products-header">
                            <div></div>
                            <div>–¢–æ–≤–∞—Ä</div>
                            <div>–¶–µ–Ω–∞</div>
                            <div>–î–µ–π—Å—Ç–≤–∏—è</div>
                        </div>
                        <div id="productsList"></div>
                    </div>
                </div>

                <div class="admin-tab-content" id="ordersTab">
                    <div class="search-box">
                        <input type="text" id="orderSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ ID, –∏–º–µ–Ω–∏ –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É..." class="search-input" onkeyup="filterOrders()">
                    </div>

                    <div class="admin-table">
                        <div class="table-header orders-header">
                            <div>ID</div>
                            <div>–ö–ª–∏–µ–Ω—Ç</div>
                            <div>–°—É–º–º–∞</div>
                            <div>–°—Ç–∞—Ç—É—Å</div>
                            <div>–î–µ–π—Å—Ç–≤–∏—è</div>
                        </div>
                        <div id="ordersList"></div>
                    </div>
                </div>

                <div class="admin-tab-content" id="adminsTab">
                    <div class="product-form" id="adminFormContainer">
                        <div class="form-title">üë§ –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</div>
                        <div class="form-row">
                            <input type="text" id="adminTelegramId" placeholder="Telegram ID" class="settings-input">
                            <input type="text" id="adminUsername" placeholder="Username (@nickname)" class="settings-input">
                        </div>
                        <div class="form-row">
                            <input type="text" id="adminFirstName" placeholder="–ò–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" class="settings-input">
                            <select id="adminRole" class="settings-input">
                                <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                <option value="owner">–í–ª–∞–¥–µ–ª–µ—Ü</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="addAdmin()">
                                <i class="fas fa-user-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                            </button>
                            <button class="btn btn-secondary" onclick="resetAdminForm()">
                                <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                        </div>
                    </div>

                    <div class="admin-table">
                        <div class="table-header admins-header">
                            <div>ID</div>
                            <div>–ò–º—è</div>
                            <div>Username</div>
                            <div>–†–æ–ª—å</div>
                            <div>–î–µ–π—Å—Ç–≤–∏—è</div>
                        </div>
                        <div id="adminsList"></div>
                    </div>
                </div>

                <div class="admin-tab-content" id="settingsTab">
                    <div class="product-form">
                        <div class="form-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞</div>
                        
                        <div class="settings-group">
                            <div class="settings-label">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                            <div class="form-row">
                                <input type="text" id="shopNameInput" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞" class="settings-input">
                            </div>
                        </div>

                        <div class="settings-group">
                            <div class="settings-label">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞</div>
                            <div class="theme-grid" id="themeGrid"></div>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-primary btn-lg" onclick="saveShopSettings()">
                                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="floating-buttons">
                <button class="admin-button" onclick="switchToAdminView()" title="–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è" id="adminButton">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        
            <div class="modal" id="orderModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-title"><i class="fas fa-shopping-bag"></i> –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</div>
                        <button class="close-modal" id="closeOrder">√ó</button>
                    </div>
                    
                    <div class="success-state">
                        <div class="success-icon">üéâ</div>
                        <div class="success-title">–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∑–∞–∫–∞–∑!</div>
                        <div class="success-message">
                            –î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞—à–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É –≤ Telegram:
                        </div>
                        <div style="background:#f8f9fa;padding:16px;border-radius:12px;margin:16px 0;text-align:center">
                            <div style="font-size:18px;font-weight:700;color:var(--primary)">@ImTatyanaSolovyova</div>
                        </div>
                        <button class="btn btn-primary btn-lg" onclick="contactManager()" style="width:100%">
                            <i class="fab fa-telegram"></i> –ù–∞–ø–∏—Å–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É
                        </button>
                        <button class="btn btn-secondary" onclick="closeOrderModal()" style="width:100%;margin-top:8px">
                            <i class="fas fa-shopping-bag"></i> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
                        </button>
                    </div>
                </div>
            </div>
        
            <div class="modal" id="editProductModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-title"><i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</div>
                        <button class="close-modal" id="closeEditProduct">√ó</button>
                    </div>
                    <div id="editProductForm">
                        <input type="hidden" id="editProductId">
                        <div class="form-group">
                            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                            <input type="text" class="settings-input" id="editProductName">
                        </div>
                        <div class="form-group">
                            <label class="form-label">–¶–µ–Ω–∞</label>
                            <input type="number" class="settings-input" id="editProductPrice">
                        </div>
                        <div class="form-group">
                            <label class="form-label">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                            <input type="text" class="settings-input" id="editProductImage">
                        </div>
                        <div class="form-group">
                            <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea class="settings-input" id="editProductDescription" rows="3"></textarea>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="editProductAvailable" checked>
                            <label class="checkbox-label">–¢–æ–≤–∞—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–∫–∞–∑–∞</label>
                        </div>
                        <button class="btn btn-primary btn-lg" onclick="updateProduct()" style="width:100%">
                            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                        </button>
                    </div>
                </div>
            </div>
        
            <script>
                let tg = window.Telegram.WebApp;
                tg.expand();
                tg.ready();
                
                let products = [];
                let isAdmin = false;
                let currentUserRole = '';
                let adminData = {
                    products: [],
                    orders: [],
                    admins: [],
                    stats: {},
                    settings: {},
                    themes: []
                };
        
                let currentProduct = null;
        
                // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                function showToast(message, type = 'success') {
                    const toast = document.getElementById('toast');
                    const toastMessage = document.getElementById('toastMessage');
                    const toastIcon = document.getElementById('toastIcon');
                    
                    toastMessage.textContent = message;
                    toast.className = 'toast';
                    toast.classList.add(type);
                    
                    if (type === 'success') {
                        toastIcon.className = 'fas fa-check-circle';
                    } else if (type === 'error') {
                        toastIcon.className = 'fas fa-times-circle';
                    } else {
                        toastIcon.className = 'fas fa-info-circle';
                    }
                    
                    toast.classList.add('show');
                    setTimeout(() => {
                        toast.classList.remove('show');
                    }, 2000);
                }
        
                // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
                async function loadProducts() {
                    try {
                        const response = await fetch('/api/products');
                        if (!response.ok) throw new Error('Network error');
                        products = await response.json();
                        renderProducts();
                    } catch (error) {
                        console.error('Error loading products:', error);
                        showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–∞–ª–æ–≥–∞', 'error');
                        renderProducts([]);
                    }
                }
        
                // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
                function renderProducts() {
                    const grid = document.getElementById('productsGrid');
                    
                    if (products.length === 0) {
                        grid.innerHTML = '<div class="loading"><div>–¢–æ–≤–∞—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</div></div>';
                        return;
                    }
                    
                    grid.innerHTML = '';
                    
                    products.forEach(product => {
                        const productCard = document.createElement('div');
                        productCard.className = 'product-card';
                        productCard.innerHTML = `
                            <div class="product-image">
                                <img src="${product.image_url}" alt="${product.name}" loading="lazy" 
                                     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yMDAgMTUwQzIyNSAyMDAgMjUwIDE1MCAyMDAgMTAwQzE1MCAxNTAgMTc1IDIwMCAyMDAgMTUwWiIgZmlsbD0iI0U1RTVFNSIvPgo8L3N2Zz4K'">
                            </div>
                            <div class="product-content">
                                <div class="product-title">${product.name}</div>
                                <div class="product-description">${product.description}</div>
                                <div class="product-footer">
                                    <div class="product-price">${product.price.toLocaleString()} ‚ÇΩ</div>
                                    <button class="order-btn" onclick="orderProduct(${product.id})">
                                        <i class="fas fa-shopping-bag"></i> –ó–∞–∫–∞–∑–∞—Ç—å
                                    </button>
                                </div>
                            </div>
                        `;
                        grid.appendChild(productCard);
                    });
                }
        
                // –ó–∞–∫–∞–∑ —Ç–æ–≤–∞—Ä–∞
                function orderProduct(productId) {
                    currentProduct = products.find(p => p.id === productId);
                    if (currentProduct) {
                        document.getElementById('orderModal').style.display = 'flex';
                        tg.HapticFeedback.impactOccurred('soft');
                    }
                }
        
                // –°–≤—è–∑—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
                function contactManager() {
                    const productInfo = currentProduct ? 
                        `–ó–∞–∫–∞–∑: ${currentProduct.name} - ${currentProduct.price}‚ÇΩ` : 
                        '–•–æ—á—É —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑';
                    
                    const message = encodeURIComponent(productInfo);
                    window.open(`https://t.me/ImTatyanaSolovyova?text=${message}`, '_blank');
                    closeOrderModal();
                    showToast('–°–≤—è–∂–∏—Ç–µ—Å—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è', 'success');
                }
        
                function closeOrderModal() {
                    document.getElementById('orderModal').style.display = 'none';
                    currentProduct = null;
                }
        
                // –ê–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏
                async function checkAdminAccess() {
                    try {
                        const telegramId = String(tg.initDataUnsafe.user?.id || '');
                        const response = await fetch('/api/admin', {
                            headers: { 'Telegram-Id': telegramId }
                        });
                        const data = await response.json();
                        
                        isAdmin = data.is_admin === true && data.is_active !== false;
                        currentUserRole = data.role || '';
                        
                        if (isAdmin) {
                            document.getElementById('adminButton').style.display = 'flex';
                        }
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥–º–∏–Ω-–¥–æ—Å—Ç—É–ø–∞:', error);
                    }
                }
        
                function switchToCustomerView() {
                    document.getElementById('adminPanel').style.display = 'none';
                    document.getElementById('customerView').style.display = 'block';
                    document.getElementById('adminButton').style.display = isAdmin ? 'flex' : 'none';
                }
        
                function switchToAdminView() {
                    if (!isAdmin) {
                        showToast('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'error');
                        return;
                    }
                    document.getElementById('customerView').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    document.getElementById('adminButton').style.display = 'none';
                    loadAdminData();
                }
        
                // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∞–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –±—ã–ª–∏...
                // [–ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Å—Ç–∞–ª—å–Ω–æ–π JavaScript –∫–æ–¥ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏]
        
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                function initApp() {
                    loadProducts();
                    checkAdminAccess();
                    setupEventListeners();
                }
        
                function setupEventListeners() {
                    document.getElementById('closeOrder').addEventListener('click', closeOrderModal);
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.addEventListener('click', (e) => {
                            if (e.target === modal) {
                                modal.style.display = 'none';
                            }
                        });
                    });
                }
        
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', initApp);
                } else {
                    initApp();
                }
            </script>
        </body>
        </html>